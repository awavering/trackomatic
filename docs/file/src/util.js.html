<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/util.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
</head>
<body class="layout-container">

<header>
  <a href="./">Home</a>
  <a href="identifiers.html">Identifier</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a data-ice="repoURL" href="https://github.com/vigetlabs/trackomatic.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/plugin.js~Plugin.html">Plugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/trackomatic.js~Trackomatic.html">Trackomatic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-once">once</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-providePlugin">providePlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-config">config</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-plugin">plugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-trackomatic">trackomatic</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-util">util</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">plugins</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/plugins/errorReportingPlugin.js~ErrorReportingPlugin.html">ErrorReportingPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/plugins/firstInputPlugin.js~FirstInputPlugin.html">FirstInputPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/plugins/linkTrackingPlugin.js~LinkTrackingPlugin.html">LinkTrackingPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/plugins/viewportTrackingPlugin.js~ViewportTrackingPlugin.html">ViewportTrackingPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-errorReportingPlugin">errorReportingPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-firstInputPlugin">firstInputPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-linkTrackingPlugin">linkTrackingPlugin</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-viewportTrackingPlugin">viewportTrackingPlugin</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/util.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">var config = require(&apos;./config&apos;)

/**
 * Utility functions
 **/
const util = {
  noop() {},

  keyCode(e) {
    e = e || window.event
    return e.which || e.keyCode
  },

  /**
   * Allows easy extraction of domain, pathname, etc off of a full URL.
   * @param {string} href - the url to parse
   */
  createAnchor(href) {
    var target = document.createElement(&apos;a&apos;)
    target.href = href
    return target
  },

  /**
   * A small wrapper for `createAnchor` that returns just the `pathname`
   * @param {string} href - the url to parse
   */
  getPathname(href) {
    // normalize the pathname, since IE omits the leading slash.
    return href &amp;&amp; this.createAnchor(href).pathname.replace(config.REGEX.LEADING_SLASH, &apos;/&apos;)
  },

  /**
   * Capitalizes the first letter of a string. Useful for combining inconsistent data sources.
   * @param {string} string - the string to capitalize
   */
  capitalize(string) {
    return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase()
  },

  /**
   * Turns strings into slugs - useful for combining inconsistent data sources
   *
   * @function slugify
   * @param   { String } text - the string to slugify
   * @returns { String }      - the slugified string
   */
  slugify(text) {
    return text.toString()
      .toLowerCase()
      .replace(config.REGEX.SPACES, &apos;-&apos;)           // Replace spaces with -
      .replace(config.REGEX.NON_WORD, &apos;&apos;)          // Remove all non-word chars
      .replace(config.REGEX.MULTIPLE_HYPHENS, &apos;-&apos;) // Replace multiple - with single -
      .replace(config.REGEX.LEADING_HYPHENS, &apos;&apos;)   // Trim - from start of text
      .replace(config.REGEX.TRAILING_HYPHENS, &apos;&apos;) // Trim - from end of text
  },

  /**
   * Reads cookies.
   */
  readCookie() {
    return (config.REGEX.COOKIE.exec(document.cookie) || []).pop()
  },

  /**
   * Writes cookies. This function is a no-op if `_trackomatic.options.nocookie` is `true`.
   * @param {string} name - the name for the cookie value
   * @param {mixed} value - the value to be stored as a cookie
   * @param {number} days - the number of days to store the cookie for
   */
  createCookie(name, value, days) {
    if(_trackomatic.options.nocookie) return

    var expires = days ? &apos; expires=&apos; + (new Date(days * 864E5 + (new Date()).getTime())).toGMTString() : &apos;&apos;
    document.cookie = `${ name }=${ value }${ expires }; path=/; domain=${ document.location.hostname }`
  },

  /**
   * Debounces function calls.
   */
  debounce(func, wait, immediate) {
    var timeout

    return function() {
      var context = this
      var args = arguments

      var later = function() {
        timeout = null
        if (!immediate) func.apply(context, args)
      }

      var callNow = immediate &amp;&amp; !timeout

      clearTimeout(timeout)
      timeout = setTimeout(later, wait)

      if (callNow) func.apply(context, args)
    }
  },

  /**
   * Gets the viewport size.
   */
  getViewportSize() {
    if (typeof window.innerWidth !== &apos;undefined&apos;) {
      return {
        width  : window.innerWidth,
        height : window.innerHeight
      }
    } else if (typeof document.documentElement !== &apos;undefined&apos;
        &amp;&amp; typeof document.documentElement.clientWidth !== &apos;undefined&apos;
        &amp;&amp; document.documentElement.clientWidth !== 0) {
      return {
        width  : document.documentElement.clientWidth,
        height : document.documentElement.clientHeight
      }
    } else {
      return {
        width  : document.body.clientWidth,
        height : document.body.clientHeight
      }
    }
  },

  getViewportRatio(size) {
    return (size.width / size.height).toPrecision(2)
  },

  /**
   * Rounds numbers.
   */
  roundXtoY(x, y) {
    var upper = Math.ceil(x/y) * y
    var lower = Math.floor(x/y) * y

    return (x - lower &lt; upper - x) ? lower : upper
  },

  createNavigationHandler(link) {
    return function() {
      if (link.target) {
        window.open(link.href, link.target)
      } else {
        window.location = link.href
      }
    }
  },

  getHost(url) {
    return url.replace(config.REGEX.HTTP_PROTOCOL, &apos;&apos;).split(&apos;/&apos;)[0]
  },

  getLink(node) {
    if (node === document.documentElement) {
      return false
    } else if (node.tagName.toLowerCase() === &apos;a&apos;) {
      return node
    } else {
      return this.getLink(node.parentNode)
    }
  },

  getURLParams() {
    let map = {}
    location.href.replace(config.REGEX.QUERY_PARAMS, (m, k, v) =&gt; map[k] = v)
    return map
  },

  isArray(item) {
    return Object.prototype.toString.call(item) === &apos;[object Array]&apos;
  },

  regexify(input) {
    input = this.isArray(input) ? input : [input]
    return new RegExp(input.map(s =&gt; s.replace(/\./g, &apos;\\.&apos;)).join(&apos;|&apos;), &apos;i&apos;)
  },

  /**
   * Wraps a function and guards it from being invoked more than once
   *
   * @function callOnce
   * @param   { Function } fn - the function to guard
   * @returns { Function }    - the wrapped function
   */
  callOnce(fn) {
    let called = false

    return function callOnceWrappedFunction() {
      if (called) return
      fn()
      called = true
    }
  }
}

export default util
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.3.1)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
